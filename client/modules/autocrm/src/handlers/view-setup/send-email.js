"use strict";var p=Object.defineProperty;var w=(t,i,e)=>i in t?p(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e;var c=(t,i,e)=>(w(t,typeof i!="symbol"?i+"":i,e),e);var r=(t,i,e)=>new Promise((a,n)=>{var l=s=>{try{o(e.next(s))}catch(d){n(d)}},m=s=>{try{o(e.throw(s))}catch(d){n(d)}},o=s=>s.done?a(s.value):Promise.resolve(s.value).then(l,m);o((e=e.apply(t,i)).next())});define(()=>{class t{constructor(e){c(this,"view");this.view=e}process(){const e=this.view.getMetadata().get(["scopes",this.view.scope]);if(!e)return;const a=!!e.hideSendEmailButton,n=e.type;a||n==="BasePlus"&&this.addSendEmailButton()}addSendEmailButton(){this.view.addMenuItem("buttons",{name:"sendEmail",label:"Send Email",iconClass:"fas fa-envelope fa-sm",action:"sendEmail"}),this.view.actionSendEmail=()=>this.sendEmail()}sendEmail(){return r(this,null,function*(){const e={status:"Draft",parentId:this.view.model.id,parentType:this.view.model.entityType,parentName:this.view.model.get("name")},a=this.view.getMetadata().get(["clientDefs",this.view.scope,"modalViews","compose"])||this.view.getMetadata().get(["clientDefs","Email","modalViews","compose"])||"views/modals/compose-email";Espo.Ui.notify(" ... "),yield(yield this.view.createView("quickCreate",a,{attributes:e})).render(),Espo.Ui.notify(!1)})}}return Object.assign(t.prototype,Backbone.Events),t});
