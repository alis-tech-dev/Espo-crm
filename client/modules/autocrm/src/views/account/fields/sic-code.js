"use strict";var g=Object.defineProperty;var f=(r,e,s)=>e in r?g(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var c=(r,e,s)=>(f(r,typeof e!="symbol"?e+"":e,s),s);var p=(r,e,s)=>new Promise((d,t)=>{var i=n=>{try{o(s.next(n))}catch(l){t(l)}},a=n=>{try{o(s.throw(n))}catch(l){t(l)}},o=n=>n.done?d(n.value):Promise.resolve(n.value).then(i,a);o((s=s.apply(r,e)).next())});define(["views/fields/varchar","lib!zod"],(r,e)=>{const s=e.object({attributes:e.object({vatId:e.optional(e.string()),slovakVatId:e.optional(e.string()),name:e.string(),billingAddressCity:e.string(),billingAddressStreet:e.string(),billingAddressState:e.string(),billingAddressPostalCode:e.string(),billingAddressCountry:e.string()})});return class extends r{constructor(){super(...arguments);c(this,"editTemplate","autocrm:account/fields/sic-code/edit")}setup(){this.events["click .sic-fill-provider"]=t=>{t.preventDefault();const i=t.currentTarget.getAttribute("data-provider-id");this.actionFillFromProvider(i)},super.setup()}data(){const t=super.data(),i=this.getProviders();return t.providers=i,t.providersEnabled=i.length>0,t}getProviders(){const t=[];return this.getConfig().get("aresEnabled")&&t.push({id:"Ares",label:this.translate("Ares","fillProviders","Account")}),this.getConfig().get("finstatEnabled")&&t.push({id:"Finstat",label:this.translate("Finstat","fillProviders","Account")}),t}actionFillFromProvider(t){return p(this,null,function*(){const i=this.model.get(this.name);if(!i){Espo.Ui.warning(this.translate("missingSicCode","messages","Account"));return}Espo.Ui.notify(" ... ");const a=yield Espo.Ajax.getRequest(`${t}/fill/${i}`);Espo.Ui.notify(!1);try{const o=s.parse(a);this.process(o)}catch(o){if(o instanceof e.ZodError){Espo.Ui.error(this.translate(`invalid${t}Response`,"messages","Account")),console.error(o);return}throw o}})}process(t){for(const[i,a]of Object.entries(t.attributes))this.model.set(i,a)}}});
